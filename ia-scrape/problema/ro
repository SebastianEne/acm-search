<div class="wiki_text_block"><p> </p>

<table style="margin-left:auto;margin-right:auto;" cellspacing="0"><tr><td><strong>Fişierul intrare/ieşire:</strong></td><td>ro.in, ro.out</td><td><strong>Sursă</strong></td><td>.campion 2007</td></tr><tr><td><strong>Autor</strong></td><td><a href="/cauta-probleme?tag_id%5B%5D=136">Mugurel Ionut Andreica</a></td><td><a href="http://infoarena.ro/implica-te/extinde-arhiva/"><strong>Adăugată de</strong></a></td><td><span class="tiny-user"><a href="http://infoarena.ro/utilizator/azotlichid"><img src="/utilizator/azotlichid?action=download&amp;file=avatar&amp;resize=L16x16" alt="azotlichid">Adrian Vladu</a> <a title="Rating azotlichid: 631" class="rating-badge-4" href="http://infoarena.ro/utilizator/azotlichid?action=rating">•</a><span class="username"><a href="http://infoarena.ro/utilizator/azotlichid">azotlichid</a></span></span></td></tr><tr><td><strong>Timp execuţie pe test</strong></td><td>1.3 sec</td><td><strong>Limită de memorie</strong></td><td>30720 kbytes</td></tr><tr><td><strong>Scorul tău în arhivă</strong></td><td>N/A</td><td><strong>Dificultate</strong></td><td>N/A</td></tr></table><p style="float: right; margin-right: 1em"><a href="http://infoarena.ro/monitor?task=ro">Vezi solutiile trimise</a></p>

<h1>Ro<br></h1>

<p>In Romania exista <var>N</var> orase interconectate prin <var>M</var> autostrazi. O autostrada leaga exact 2 orase (de exemplu, autostrazile Bucuresti-Pitesti sau Bucuresti-Constanta). Toate autostrazile sunt deschise circulatiei in ambele sensuri si se poate ajunge din orice oras in orice alt oras folosind autostrazile existente. In urma aderarii la Uniunea Europeana, guvernul va trebui sa ia masuri pentru a respecta regulile europene referitoare la infrastructura rutiera. Aceste reguli mentioneza ca cel putin unul din cele 2 orase intre care exista o autostrada trebuie sa aiba rangul de capitala europeana. Initial, nici unul dintre cele <var>N</var> orase nu are rangul de capitala europeana si pentru fiecare din ele se cunoaste suma necesara (in milioane de euro) pentru a fi modernizat si promovat la rangul respectiv.<br>
Intrucat fondurile guvernului sunt limitate, determinati care este suma totala minima pe care va trebui sa o cheltuiasca guvernul cu promovarea unor orase la rangurile de capitale europene in asa fel incat sa fie respectate regulile europene referitoare la infrastructura rutiera.<br>
Pentru a rezolva aceasta problema aveti la dispozitie o informatie suplimentara din partea guvernului, si anume: oricum am alege o submultime de 14 orase dintre cele <var>N</var>, exista in aceasta submultime cel putin o pereche de orase <var>A</var> si <var>B</var> cu proprietatea ca exista un oras <var>C</var> diferit de <var>A</var> si <var>B</var> (nu neaparat din submultimea aleasa) astfel incat, daca s-ar inchide circulatia in ambele sensuri pe toate autostrazile care au o extremitate in <var>C</var>, atunci nu va mai exista nici un drum intre orasele <var>A</var> si <var>B</var> folosind autostrazile ramase deschise circulatiei. Aceasta conditie poate fi reformulata astfel: Daca privim infrastructura rutiera a Romaniei ca un graf neorientat conex cu <var>N</var> noduri si <var>M</var> muchii, orice componenta biconexa a acestui graf contine cel mult 13 noduri.</p>

<h2>Date de intrare</h2>

<p>Fisierul de intrare contine pe prima linie numerele intregi <var>N</var>, <var>M</var> separate printr-un spatiu, reprezentand numarul de orase si numarul de autostrazi. Urmatoarea linie contine <var>N</var> numere intregi <var>S<sub>i</sub></var>, separate prin cate un spatiu, reprezentand sumele necesare promovarii fiecarui oras <var>i</var> (de la <var>1</var> la <var>N</var>) la rangul de capitala europeana. Urmatoarele <var>M</var> linii contin cate 2 numere intregi distincte separate printr-un spatiu, <var>U</var> si <var>V</var>, avand semnificatia ca exista o autostrada intre orasul <var>U</var> si orasul <var>V</var>.</p>

<h2>Date de iesire</h2>

<p>Fisierul de iesire va contine pe prima linie suma minima pe care trebuie sa o plateasca guvernul pentru a respecta regulile europene referitoare la infrastructura rutiera. Pe a doua linie veti afisa numarul <var>O</var>, reprezentand numarul de orase promovate la rangul de capitala europeana. A treia linie a fisierului va contine <var>O</var> numere intregi distincte intre <var>1</var> si <var>N</var>, separate prin cate un spatiu, reprezentand orasele care au fost alese pentru a fi promovate la rangul de capitala europeana.</p>

<h2>Restrictii</h2>


<ul><li><var>1 ≤ N ≤ 2007</var></li>
<li><var>N - 1 ≤ M ≤ 10.000</var></li>
<li><var>1 ≤ S<sub>i</sub> ≤ 1000000</var></li>
<li>Orasele sunt numerotate cu numere intregi de la <var>1</var> la <var>N</var>.</li>
<li>Intre 2 orase diferite va exista cel mult o autostrada.</li>
<li>Cel putin <var>20%</var> din fisierele de test vor avea <var>M = N - 1</var>.</li>
<li>Orasele alese pentru a fi promovate la rangul de capitala europeana pot fi afisate in orice ordine.</li>
</ul><h2>Exemplu</h2>

<table class="example" cellspacing="0"><tr><th>ro.in</th><th>ro.out</th></tr><tr><td>15 21<br>
9 8 7 100 99 2 3 8 4 6 7 2 1 6 2<br>
1 2<br>
2 4<br>
4 5<br>
5 6<br>
2 6<br>
1 5<br>
4 3<br>
3 7<br>
7 9<br>
9 8<br>
8 4<br>
4 7<br>
3 9<br>
5 10<br>
10 13<br>
5 12<br>
12 13<br>
12 15<br>
12 14<br>
15 14<br>
13 11<br></td><td>129<br>
9<br>
1 4 6 7 9 10 12 13 15<br></td></tr></table><div class="macroMessage">Trebuie sa te autentifici pentru a trimite solutii. <a href="/login">Click aici</a></div>



<p><a href="http://infoarena.ro/documentatie/tutorial">Cum se trimit solutii?</a></p></div>